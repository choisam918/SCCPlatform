<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ë∂≥ÁêÉÊà∞Ë°ìÁ≥ªÁµ± - ÁÆ°ÁêÜÈ†ÅÈù¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .admin-header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .admin-header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .admin-header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .admin-content {
            padding: 30px;
            max-height: 75vh;
            overflow-y: auto;
        }

        .admin-section {
            margin-bottom: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 5px solid #1e3c72;
        }

        .admin-section h2 {
            color: #1e3c72;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .admin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .admin-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: 1px solid #e9ecef;
        }

        .admin-card h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .admin-btn {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .admin-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(30, 60, 114, 0.3);
        }

        .admin-btn.danger {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
        }

        .admin-btn.success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .admin-btn.warning {
            background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
            color: #212529;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #1e3c72;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.9);
            color: #1e3c72;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: white;
            transform: translateY(-2px);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        .data-table th {
            background: #1e3c72;
            color: white;
            font-weight: 600;
        }

        .data-table tr:hover {
            background: #f8f9fa;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal h3 {
            margin-bottom: 20px;
            color: #1e3c72;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #495057;
            font-weight: 600;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #1e3c72;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: #000;
        }

        /* ÁôªÂÖ•È†ÅÈù¢Ê®£Âºè */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .login-box {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            width: 90%;
            max-width: 400px;
            text-align: center;
        }

        .login-box h1 {
            color: #1e3c72;
            margin-bottom: 30px;
            font-size: 2rem;
        }

        .login-box .form-group {
            margin-bottom: 25px;
        }

        .login-box input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .login-box input:focus {
            outline: none;
            border-color: #1e3c72;
        }

        .login-btn {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            width: 100%;
            transition: all 0.3s ease;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(30, 60, 114, 0.3);
        }

        .error-message {
            color: #dc3545;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .hidden {
            display: none !important;
        }

        @media (max-width: 768px) {
            .admin-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .admin-header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <!-- ÁôªÂÖ•È†ÅÈù¢ -->
    <div id="loginPage" class="login-container">
        <button class="back-btn" onclick="goBack()">‚Üê ËøîÂõû‰∏ªÈ†Å</button>
        <div class="login-box">
            <h1>üîê ÁÆ°ÁêÜÂì°ÁôªÂÖ•</h1>
            <div class="form-group">
                <label for="adminPassword">ÁÆ°ÁêÜÂì°ÂØÜÁ¢º</label>
                <input type="password" id="adminPassword" placeholder="Ë´ãËº∏ÂÖ•ÁÆ°ÁêÜÂì°ÂØÜÁ¢º" onkeypress="handlePasswordKeyPress(event)">
            </div>
            <button class="login-btn" onclick="checkPassword()">ÁôªÂÖ•</button>
            <div id="errorMessage" class="error-message hidden"></div>
        </div>
    </div>

    <!-- ÁÆ°ÁêÜÈ†ÅÈù¢ÂÖßÂÆπ -->
    <div id="adminPage" class="hidden">
        <button class="back-btn" onclick="goBack()">‚Üê ËøîÂõû‰∏ªÈ†Å</button>
        
        <div class="admin-container">
            <div class="admin-header">
                <h1>‚öΩ Ë∂≥ÁêÉÊà∞Ë°ìÁ≥ªÁµ±ÁÆ°ÁêÜ</h1>
                <p>Á≥ªÁµ±ÁÆ°ÁêÜËàáÊï∏ÊìöÁ∂≠Ë≠∑</p>
            </div>
            
            <div class="admin-content">
            <!-- Áµ±Ë®àÊ¶ÇË¶Ω -->
            <div class="admin-section">
                <h2>üìä Á≥ªÁµ±Áµ±Ë®à</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalFormations">0</div>
                        <div class="stat-label">‰øùÂ≠òÁöÑÈô£Âûã</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalNotes">0</div>
                        <div class="stat-label">Ë≥Ω‰∫ãÁ≠ÜË®ò</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalPlayers">30</div>
                        <div class="stat-label">ÁêÉÂì°Á∏ΩÊï∏</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="lastBackup">-</div>
                        <div class="stat-label">ÊúÄÂæåÂÇô‰ªΩ</div>
                    </div>
                </div>
            </div>

            <!-- Êï∏ÊìöÁÆ°ÁêÜ -->
            <div class="admin-section">
                <h2>üóÑÔ∏è Êï∏ÊìöÁÆ°ÁêÜ</h2>
                <div class="admin-grid">
                    <div class="admin-card">
                        <h3>Èô£ÂûãÁÆ°ÁêÜ</h3>
                        <p>ÁÆ°ÁêÜ‰øùÂ≠òÁöÑÊà∞Ë°ìÈô£ÂûãË®òÈåÑ</p>
                        <button class="admin-btn" onclick="viewFormations()">Êü•ÁúãÈô£Âûã</button>
                        <button class="admin-btn danger" onclick="clearAllFormations()">Ê∏ÖÁ©∫ÊâÄÊúâ</button>
                    </div>
                    
                    <div class="admin-card">
                        <h3>Á≠ÜË®òÁÆ°ÁêÜ</h3>
                        <p>ÁÆ°ÁêÜË≥Ω‰∫ãÁ≠ÜË®òËàáË®òÈåÑ</p>
                        <button class="admin-btn" onclick="viewNotes()">Êü•ÁúãÁ≠ÜË®ò</button>
                        <button class="admin-btn danger" onclick="clearAllNotes()">Ê∏ÖÁ©∫ÊâÄÊúâ</button>
                    </div>
                    
                    <div class="admin-card">
                        <h3>Êï∏ÊìöÂÇô‰ªΩ</h3>
                        <p>ÂÇô‰ªΩËàáÈÇÑÂéüÈô£ÂûãÁ≠ÜË®ò</p>
                        <button class="admin-btn success" onclick="backupData()">ÂÇô‰ªΩÊï∏Êìö</button>
                        <button class="admin-btn warning" onclick="restoreData()">ÈÇÑÂéüÊï∏Êìö</button>
                    </div>
                    
                    <div class="admin-card">
                        <h3>Á≥ªÁµ±ÂÇô‰ªΩ</h3>
                        <p>ÂÆåÊï¥Á≥ªÁµ±ÂÇô‰ªΩËàáÈÇÑÂéü</p>
                        <button class="admin-btn success" onclick="backupSystem()">Á≥ªÁµ±ÂÇô‰ªΩ</button>
                        <button class="admin-btn warning" onclick="restoreSystem()">Á≥ªÁµ±ÈÇÑÂéü</button>
                        <button class="admin-btn" onclick="viewBackupHistory()">ÂÇô‰ªΩÊ≠∑Âè≤</button>
                        <button class="admin-btn" onclick="setupAutoBackup()">Ëá™ÂãïÂÇô‰ªΩË®≠ÂÆö</button>
                    </div>
                    
                    <div class="admin-card">
                        <h3>Á≥ªÁµ±ÈáçÁΩÆ</h3>
                        <p>ÈáçÁΩÆÁ≥ªÁµ±Âà∞ÂàùÂßãÁãÄÊÖã</p>
                        <button class="admin-btn danger" onclick="resetSystem()">ÈáçÁΩÆÁ≥ªÁµ±</button>
                    </div>
                </div>
            </div>

            <!-- Á≥ªÁµ±Ë®≠ÂÆö -->
            <!-- Ê≠§ÂçÄÂ°äÂ∑≤ÁßªÈô§ -->
        </div>
    </div>

    <!-- Èô£ÂûãÂàóË°®Ê®°ÊÖãÊ°Ü -->
    <div id="formationsModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('formationsModal')">&times;</span>
            <h3>‰øùÂ≠òÁöÑÈô£ÂûãÂàóË°®</h3>
            <div id="formationsList"></div>
        </div>
    </div>

    <!-- Á≠ÜË®òÂàóË°®Ê®°ÊÖãÊ°Ü -->
    <div id="notesModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('notesModal')">&times;</span>
            <h3>Ë≥Ω‰∫ãÁ≠ÜË®òÂàóË°®</h3>
            <div id="notesList"></div>
        </div>
    </div>

    <!-- ÂÇô‰ªΩÊ≠∑Âè≤Ê®°ÊÖãÊ°Ü -->
    <div id="backupHistoryModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('backupHistoryModal')">&times;</span>
            <h3>Á≥ªÁµ±ÂÇô‰ªΩÊ≠∑Âè≤</h3>
            <div id="backupHistoryList"></div>
        </div>
    </div>

    <script>
        // ÁÆ°ÁêÜÂì°ÂØÜÁ¢º
        const ADMIN_PASSWORD = 'admin@123';
        
        // È†ÅÈù¢ËºâÂÖ•ÊôÇÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            // Ê™¢Êü•ÊòØÂê¶Â∑≤Á∂ìÁôªÂÖ•
            if (sessionStorage.getItem('adminLoggedIn') === 'true') {
                showAdminPage();
                checkBackupReminder(); // Ê™¢Êü•ÂÇô‰ªΩÊèêÈÜí
            } else {
                showLoginPage();
            }
        });

        // Ê™¢Êü•ÂÇô‰ªΩÊèêÈÜí
        function checkBackupReminder() {
            const autoBackupEnabled = localStorage.getItem('autoBackupEnabled') === 'true';
            if (!autoBackupEnabled) return;
            
            const nextReminder = localStorage.getItem('nextBackupReminder');
            if (!nextReminder) return;
            
            const now = new Date();
            const reminderTime = new Date(nextReminder);
            
            if (now >= reminderTime) {
                // È°ØÁ§∫ÂÇô‰ªΩÊèêÈÜí
                if (confirm('üìÖ ÂÇô‰ªΩÊèêÈÜí\n\nË∑ùÈõ¢‰∏äÊ¨°ÂÇô‰ªΩÂ∑≤Á∂ìË∂ÖÈÅéË®≠ÂÆöÁöÑÊôÇÈñìÔºåÂª∫Ë≠∞ÊÇ®ÁèæÂú®ÈÄ≤Ë°åÊï∏ÊìöÂÇô‰ªΩ„ÄÇ\n\nÊòØÂê¶Ë¶ÅÁèæÂú®ÈÄ≤Ë°åÁ≥ªÁµ±ÂÇô‰ªΩÔºü')) {
                    backupSystem();
                } else {
                    // Âª∂ÈÅ≤ÊèêÈÜíÂà∞ÊòéÂ§©
                    const tomorrow = new Date();
                    tomorrow.setDate(tomorrow.getDate() + 1);
                    localStorage.setItem('nextBackupReminder', tomorrow.toISOString());
                }
            }
        }

        // È°ØÁ§∫ÁôªÂÖ•È†ÅÈù¢
        function showLoginPage() {
            document.getElementById('loginPage').classList.remove('hidden');
            document.getElementById('adminPage').classList.add('hidden');
        }

        // È°ØÁ§∫ÁÆ°ÁêÜÈ†ÅÈù¢
        function showAdminPage() {
            console.log('È°ØÁ§∫ÁÆ°ÁêÜÈ†ÅÈù¢');
            const loginPage = document.getElementById('loginPage');
            const adminPage = document.getElementById('adminPage');
            
            console.log('ÁôªÂÖ•È†ÅÈù¢ÂÖÉÁ¥†:', loginPage);
            console.log('ÁÆ°ÁêÜÈ†ÅÈù¢ÂÖÉÁ¥†:', adminPage);
            
            if (loginPage) {
                loginPage.classList.add('hidden');
                console.log('Èö±ËóèÁôªÂÖ•È†ÅÈù¢');
            }
            if (adminPage) {
                adminPage.classList.remove('hidden');
                console.log('È°ØÁ§∫ÁÆ°ÁêÜÈ†ÅÈù¢');
            }
            
            updateStats();
        }

        // Ê™¢Êü•ÂØÜÁ¢º
        function checkPassword() {
            const password = document.getElementById('adminPassword').value;
            const errorMessage = document.getElementById('errorMessage');
            
            console.log('Ê™¢Êü•ÂØÜÁ¢º:', password);
            console.log('Ê≠£Á¢∫ÂØÜÁ¢º:', ADMIN_PASSWORD);
            
            if (password === ADMIN_PASSWORD) {
                // ÁôªÂÖ•ÊàêÂäü
                console.log('ÂØÜÁ¢ºÊ≠£Á¢∫ÔºåÈ°ØÁ§∫ÁÆ°ÁêÜÈ†ÅÈù¢');
                sessionStorage.setItem('adminLoggedIn', 'true');
                showAdminPage();
                errorMessage.classList.add('hidden');
            } else {
                // ÁôªÂÖ•Â§±Êïó
                console.log('ÂØÜÁ¢ºÈåØË™§');
                errorMessage.textContent = 'ÂØÜÁ¢ºÈåØË™§ÔºåË´ãÈáçÊñ∞Ëº∏ÂÖ•ÔºÅ';
                errorMessage.classList.remove('hidden');
                document.getElementById('adminPassword').value = '';
                document.getElementById('adminPassword').focus();
            }
        }

        // ËôïÁêÜÂØÜÁ¢ºËº∏ÂÖ•Ê°ÜÁöÑ Enter Èçµ
        function handlePasswordKeyPress(event) {
            if (event.key === 'Enter') {
                checkPassword();
            }
        }

        // ÁôªÂá∫ÂäüËÉΩ
        function logout() {
            sessionStorage.removeItem('adminLoggedIn');
            showLoginPage();
        }

        // Êõ¥Êñ∞Áµ±Ë®àÊï∏Êìö
        function updateStats() {
            // Èô£ÂûãÊï∏Èáè
            const formations = JSON.parse(localStorage.getItem('footballFormations') || '[]');
            document.getElementById('totalFormations').textContent = formations.length;
            
            // Á≠ÜË®òÊï∏Èáè
            const notes = JSON.parse(localStorage.getItem('footballNotes') || '[]');
            document.getElementById('totalNotes').textContent = notes.length;
            
            // ÁêÉÂì°Êï∏Èáè (Âõ∫ÂÆö30‰∫∫)
            document.getElementById('totalPlayers').textContent = '30';
            
            // ÊúÄÂæåÂÇô‰ªΩÊôÇÈñì
            const lastBackup = localStorage.getItem('lastBackupTime');
            const lastSystemBackup = localStorage.getItem('lastSystemBackupTime');
            const backupTime = lastSystemBackup || lastBackup;
            document.getElementById('lastBackup').textContent = backupTime ? new Date(backupTime).toLocaleDateString() : 'ÁÑ°';
        }

        // ËøîÂõû‰∏ªÈ†Å
        function goBack() {
            // ‰ΩøÁî® Electron IPC ËøîÂõû‰∏ªÈ†Å
            if (window.electronAPI) {
                window.electronAPI.navigateToMain();
            } else {
                // ÂÇôÁî®ÊñπÊ°àÔºöÁõ¥Êé•Â∞éËà™
                window.location.href = 'index.html';
            }
        }

        // Êü•ÁúãÈô£Âûã
        function viewFormations() {
            const formations = JSON.parse(localStorage.getItem('footballFormations') || '[]');
            const modal = document.getElementById('formationsModal');
            const list = document.getElementById('formationsList');
            
            if (formations.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #6c757d; padding: 20px;">Êö´ÁÑ°‰øùÂ≠òÁöÑÈô£Âûã</p>';
            } else {
                let html = '<table class="data-table">';
                html += '<tr><th>Èô£ÂûãÂêçÁ®±</th><th>‰∏ªÈöä</th><th>ÂÆ¢Èöä</th><th>ÊØîÂàÜ</th><th>‰øùÂ≠òÊôÇÈñì</th><th>Êìç‰Ωú</th></tr>';
                
                formations.forEach((formation, index) => {
                    const date = new Date(formation.timestamp).toLocaleString();
                    html += `<tr>
                        <td>${formation.name}</td>
                        <td>${formation.homeTeamName || '‰∏ªÈöä'}</td>
                        <td>${formation.awayTeamName || 'ÂÆ¢Èöä'}</td>
                        <td>${formation.homeScore || 0} : ${formation.awayScore || 0}</td>
                        <td>${date}</td>
                        <td>
                            <button class="admin-btn" onclick="deleteFormation(${index})">Âà™Èô§</button>
                        </td>
                    </tr>`;
                });
                html += '</table>';
                list.innerHTML = html;
            }
            
            modal.style.display = 'block';
        }

        // Êü•ÁúãÁ≠ÜË®ò
        function viewNotes() {
            const notes = JSON.parse(localStorage.getItem('footballNotes') || '[]');
            const modal = document.getElementById('notesModal');
            const list = document.getElementById('notesList');
            
            if (notes.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #6c757d; padding: 20px;">Êö´ÁÑ°Ë≥Ω‰∫ãÁ≠ÜË®ò</p>';
            } else {
                let html = '<table class="data-table">';
                html += '<tr><th>Á≠ÜË®òÂÖßÂÆπ</th><th>ÊôÇÈñì</th><th>Êìç‰Ωú</th></tr>';
                
                notes.forEach((note, index) => {
                    const date = new Date(note.timestamp).toLocaleString();
                    html += `<tr>
                        <td>${note.content.substring(0, 50)}${note.content.length > 50 ? '...' : ''}</td>
                        <td>${date}</td>
                        <td>
                            <button class="admin-btn" onclick="deleteNote(${index})">Âà™Èô§</button>
                        </td>
                    </tr>`;
                });
                html += '</table>';
                list.innerHTML = html;
            }
            
            modal.style.display = 'block';
        }

        // Ê∏ÖÁ©∫ÊâÄÊúâÈô£Âûã
        function clearAllFormations() {
            if (confirm('Á¢∫ÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâ‰øùÂ≠òÁöÑÈô£ÂûãÂóéÔºüÊ≠§Êìç‰ΩúÁÑ°Ê≥ïÂæ©ÂéüÔºÅ')) {
                localStorage.removeItem('footballFormations');
                updateStats();
                alert('ÊâÄÊúâÈô£ÂûãÂ∑≤Ê∏ÖÁ©∫ÔºÅ');
            }
        }

        // Ê∏ÖÁ©∫ÊâÄÊúâÁ≠ÜË®ò
        function clearAllNotes() {
            if (confirm('Á¢∫ÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâË≥Ω‰∫ãÁ≠ÜË®òÂóéÔºüÊ≠§Êìç‰ΩúÁÑ°Ê≥ïÂæ©ÂéüÔºÅ')) {
                localStorage.removeItem('footballNotes');
                updateStats();
                alert('ÊâÄÊúâÁ≠ÜË®òÂ∑≤Ê∏ÖÁ©∫ÔºÅ');
            }
        }

        // ÂÇô‰ªΩÊï∏Êìö
        function backupData() {
            const backup = {
                formations: JSON.parse(localStorage.getItem('footballFormations') || '[]'),
                notes: JSON.parse(localStorage.getItem('footballNotes') || '[]'),
                timestamp: new Date().toISOString()
            };
            
            // Ê™¢Ê∏¨Ë®≠ÂÇôÈ°ûÂûã
            const isMobile = /Android|iPad|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const isHuawei = /Huawei|HONOR/i.test(navigator.userAgent);
            
            if (isMobile) {
                // ÁßªÂãïË®≠ÂÇôÔºö‰ΩøÁî®Â§öÁ®Æ‰øùÂ≠òÊñπÂºè
                showMobileBackupOptions(backup, 'Êï∏ÊìöÂÇô‰ªΩ');
            } else {
                // Ê°åÈù¢Ë®≠ÂÇôÔºöÊ≠£Â∏∏‰∏ãËºâ
                const blob = new Blob([JSON.stringify(backup, null, 2)], {type: 'application/json'});
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `football_backup_${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                localStorage.setItem('lastBackupTime', new Date().toISOString());
                updateStats();
                
                alert('Êï∏ÊìöÂÇô‰ªΩÂÆåÊàêÔºÅ\n\nüìÅ Êñá‰ª∂Â∑≤‰øùÂ≠òÂà∞ÊÇ®ÁöÑ‰∏ãËºâË≥áÊñôÂ§æ\nüìÑ Êñá‰ª∂ÂêçÔºöfootball_backup_' + new Date().toISOString().split('T')[0] + '.json\n\nüí° Âª∫Ë≠∞Ôºö\n‚Ä¢ Â∞áÂÇô‰ªΩÊñá‰ª∂‰øùÂ≠òÂà∞ÂÆâÂÖ®‰ΩçÁΩÆ\n‚Ä¢ ÂÆöÊúüÈÄ≤Ë°åÂÇô‰ªΩ\n‚Ä¢ ÂèØ‰ª•Â∞áÊñá‰ª∂Ë§áË£ΩÂà∞Èõ≤Á´ØÁ°¨Á¢ü');
            }
        }

        // ÈÇÑÂéüÊï∏Êìö
        function restoreData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const backup = JSON.parse(e.target.result);
                            if (backup.formations) {
                                localStorage.setItem('footballFormations', JSON.stringify(backup.formations));
                            }
                            if (backup.notes) {
                                localStorage.setItem('footballNotes', JSON.stringify(backup.notes));
                            }
                            updateStats();
                            alert('Êï∏ÊìöÈÇÑÂéüÊàêÂäüÔºÅ');
                        } catch (error) {
                            alert('ÈÇÑÂéüÂ§±ÊïóÔºöÊ™îÊ°àÊ†ºÂºèÈåØË™§ÔºÅ');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        // Á≥ªÁµ±ÂÇô‰ªΩ
        function backupSystem() {
            // Êî∂ÈõÜÊâÄÊúâÁ≥ªÁµ±Êï∏Êìö
            const systemBackup = {
                version: '1.0',
                timestamp: new Date().toISOString(),
                description: 'Ë∂≥ÁêÉÊà∞Ë°ìÁ≥ªÁµ±ÂÆåÊï¥ÂÇô‰ªΩ',
                
                // Ê†∏ÂøÉÊï∏Êìö
                formations: JSON.parse(localStorage.getItem('footballFormations') || '[]'),
                notes: JSON.parse(localStorage.getItem('footballNotes') || '[]'),
                
                // Á≥ªÁµ±Ë®≠ÂÆö
                systemSettings: {
                    lastBackupTime: localStorage.getItem('lastBackupTime'),
                    adminLoginTime: sessionStorage.getItem('adminLoggedIn'),
                    // ÂèØ‰ª•Ê∑ªÂä†Êõ¥Â§öÁ≥ªÁµ±Ë®≠ÂÆö
                },
                
                // Áµ±Ë®à‰ø°ÊÅØ
                statistics: {
                    totalFormations: JSON.parse(localStorage.getItem('footballFormations') || '[]').length,
                    totalNotes: JSON.parse(localStorage.getItem('footballNotes') || '[]').length,
                    totalPlayers: 30,
                    backupCreatedAt: new Date().toISOString()
                },
                
                // Á≥ªÁµ±‰ø°ÊÅØ
                systemInfo: {
                    userAgent: navigator.userAgent,
                    platform: navigator.platform,
                    language: navigator.language,
                    cookieEnabled: navigator.cookieEnabled,
                    onLine: navigator.onLine
                }
            };
            
            // Ê™¢Ê∏¨Ë®≠ÂÇôÈ°ûÂûã
            const isMobile = /Android|iPad|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const isHuawei = /Huawei|HONOR/i.test(navigator.userAgent);
            
            if (isMobile) {
                // ÁßªÂãïË®≠ÂÇôÔºö‰ΩøÁî®Â§öÁ®Æ‰øùÂ≠òÊñπÂºè
                showMobileBackupOptions(systemBackup, 'Á≥ªÁµ±ÂÇô‰ªΩ');
            } else {
                // Ê°åÈù¢Ë®≠ÂÇôÔºöÊ≠£Â∏∏‰∏ãËºâ
                const blob = new Blob([JSON.stringify(systemBackup, null, 2)], {type: 'application/json'});
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `football_system_backup_${new Date().toISOString().split('T')[0]}_${new Date().toISOString().split('T')[1].split('.')[0].replace(/:/g, '-')}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                // Êõ¥Êñ∞ÂÇô‰ªΩÊôÇÈñì
                localStorage.setItem('lastBackupTime', new Date().toISOString());
                localStorage.setItem('lastSystemBackupTime', new Date().toISOString());
                updateStats();
                
                // È°ØÁ§∫Ë©≥Á¥∞ÁöÑ‰øùÂ≠òË™™Êòé
                const fileName = `football_system_backup_${new Date().toISOString().split('T')[0]}_${new Date().toISOString().split('T')[1].split('.')[0].replace(/:/g, '-')}.json`;
                alert('Á≥ªÁµ±ÂÇô‰ªΩÂÆåÊàêÔºÅ\n\nüìÅ Êñá‰ª∂Â∑≤‰øùÂ≠òÂà∞ÊÇ®ÁöÑ‰∏ãËºâË≥áÊñôÂ§æ\nüìÑ Êñá‰ª∂ÂêçÔºö' + fileName + '\n\nüìã ÂÇô‰ªΩÂÖßÂÆπÂåÖÊã¨Ôºö\n‚Ä¢ ÊâÄÊúâÈô£ÂûãÊï∏Êìö\n‚Ä¢ ÊâÄÊúâË≥Ω‰∫ãÁ≠ÜË®ò\n‚Ä¢ Á≥ªÁµ±Ë®≠ÂÆö\n‚Ä¢ Áµ±Ë®à‰ø°ÊÅØ\n‚Ä¢ Á≥ªÁµ±Áí∞Â¢É‰ø°ÊÅØ\n\nüí° Âª∫Ë≠∞Ôºö\n‚Ä¢ Â∞áÂÇô‰ªΩÊñá‰ª∂‰øùÂ≠òÂà∞ÂÆâÂÖ®‰ΩçÁΩÆ\n‚Ä¢ ÂÆöÊúüÈÄ≤Ë°åÁ≥ªÁµ±ÂÇô‰ªΩ\n‚Ä¢ ÂèØ‰ª•Â∞áÊñá‰ª∂Ë§áË£ΩÂà∞Èõ≤Á´ØÁ°¨Á¢ü\n‚Ä¢ Âª∫Ë≠∞ÊØèÈÄ±Ëá≥Â∞ëÂÇô‰ªΩ‰∏ÄÊ¨°');
            }
        }

        // Á≥ªÁµ±ÈÇÑÂéü
        function restoreSystem() {
            if (confirm('Á≥ªÁµ±ÈÇÑÂéüÂ∞áË¶ÜËìãÊâÄÊúâÁèæÊúâÊï∏ÊìöÔºåÁ¢∫ÂÆöË¶ÅÁπºÁ∫åÂóéÔºü')) {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            try {
                                const systemBackup = JSON.parse(e.target.result);
                                
                                // È©óË≠âÂÇô‰ªΩÊñá‰ª∂Ê†ºÂºè
                                if (!systemBackup.version || !systemBackup.formations || !systemBackup.notes) {
                                    alert('ÈÇÑÂéüÂ§±ÊïóÔºö‰∏çÊòØÊúâÊïàÁöÑÁ≥ªÁµ±ÂÇô‰ªΩÊñá‰ª∂ÔºÅ');
                                    return;
                                }
                                
                                // ÈÇÑÂéüÊ†∏ÂøÉÊï∏Êìö
                                if (systemBackup.formations) {
                                    localStorage.setItem('footballFormations', JSON.stringify(systemBackup.formations));
                                }
                                if (systemBackup.notes) {
                                    localStorage.setItem('footballNotes', JSON.stringify(systemBackup.notes));
                                }
                                
                                // ÈÇÑÂéüÁ≥ªÁµ±Ë®≠ÂÆö
                                if (systemBackup.systemSettings) {
                                    if (systemBackup.systemSettings.lastBackupTime) {
                                        localStorage.setItem('lastBackupTime', systemBackup.systemSettings.lastBackupTime);
                                    }
                                }
                                
                                // Êõ¥Êñ∞Áµ±Ë®à
                                updateStats();
                                
                                // È°ØÁ§∫ÈÇÑÂéü‰ø°ÊÅØ
                                let restoreInfo = 'Á≥ªÁµ±ÈÇÑÂéüÊàêÂäüÔºÅ\n\n';
                                restoreInfo += `ÂÇô‰ªΩÁâàÊú¨Ôºö${systemBackup.version}\n`;
                                restoreInfo += `ÂÇô‰ªΩÊôÇÈñìÔºö${new Date(systemBackup.timestamp).toLocaleString()}\n`;
                                restoreInfo += `Èô£ÂûãÊï∏ÈáèÔºö${systemBackup.formations.length}\n`;
                                restoreInfo += `Á≠ÜË®òÊï∏ÈáèÔºö${systemBackup.notes.length}\n`;
                                
                                alert(restoreInfo);
                                
                            } catch (error) {
                                console.error('ÈÇÑÂéüÈåØË™§:', error);
                                alert('ÈÇÑÂéüÂ§±ÊïóÔºöÊ™îÊ°àÊ†ºÂºèÈåØË™§ÊàñÊêçÂ£ûÔºÅ');
                            }
                        };
                        reader.readAsText(file);
                    }
                };
                input.click();
            }
        }

        // ÈáçÁΩÆÁ≥ªÁµ±
        function resetSystem() {
            if (confirm('Á¢∫ÂÆöË¶ÅÈáçÁΩÆÊï¥ÂÄãÁ≥ªÁµ±ÂóéÔºüÊâÄÊúâÊï∏ÊìöÂ∞áË¢´Ê∏ÖÁ©∫ÔºåÊ≠§Êìç‰ΩúÁÑ°Ê≥ïÂæ©ÂéüÔºÅ')) {
                if (confirm('ÊúÄÂæåÁ¢∫Ë™çÔºöÁúüÁöÑË¶ÅÈáçÁΩÆÁ≥ªÁµ±ÂóéÔºü')) {
                    localStorage.clear();
                    updateStats();
                    alert('Á≥ªÁµ±Â∑≤ÈáçÁΩÆÔºÅ');
                    // ÈáçÁΩÆÂæåËá™ÂãïÁôªÂá∫‰∏¶ÂõûÂà∞‰∏ªÁï´Èù¢
                    sessionStorage.removeItem('adminLoggedIn');
                    showLoginPage();
                }
            }
        }

        // Âà™Èô§Èô£Âûã
        function deleteFormation(index) {
            if (confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄôÂÄãÈô£ÂûãÂóéÔºü')) {
                const formations = JSON.parse(localStorage.getItem('footballFormations') || '[]');
                formations.splice(index, 1);
                localStorage.setItem('footballFormations', JSON.stringify(formations));
                viewFormations(); // ÈáçÊñ∞ËºâÂÖ•ÂàóË°®
                updateStats();
            }
        }

        // Âà™Èô§Á≠ÜË®ò
        function deleteNote(index) {
            if (confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄôÂÄãÁ≠ÜË®òÂóéÔºü')) {
                const notes = JSON.parse(localStorage.getItem('footballNotes') || '[]');
                notes.splice(index, 1);
                localStorage.setItem('footballNotes', JSON.stringify(notes));
                viewNotes(); // ÈáçÊñ∞ËºâÂÖ•ÂàóË°®
                updateStats();
            }
        }

        // ÈóúÈñâÊ®°ÊÖãÊ°Ü
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Êü•ÁúãÂÇô‰ªΩÊ≠∑Âè≤
        function viewBackupHistory() {
            const modal = document.getElementById('backupHistoryModal');
            const list = document.getElementById('backupHistoryList');
            
            const lastBackup = localStorage.getItem('lastBackupTime');
            const lastSystemBackup = localStorage.getItem('lastSystemBackupTime');
            
            let html = '<div style="margin-bottom: 20px;">';
            html += '<h4 style="color: #1e3c72; margin-bottom: 10px;">ÂÇô‰ªΩË®òÈåÑ</h4>';
            
            if (lastSystemBackup) {
                const systemBackupDate = new Date(lastSystemBackup);
                html += `<div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                    <strong>üîÑ Á≥ªÁµ±ÂÇô‰ªΩ</strong><br>
                    ÊôÇÈñìÔºö${systemBackupDate.toLocaleString()}<br>
                    È°ûÂûãÔºöÂÆåÊï¥Á≥ªÁµ±ÂÇô‰ªΩ
                </div>`;
            }
            
            if (lastBackup) {
                const backupDate = new Date(lastBackup);
                html += `<div style="background: #f3e5f5; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                    <strong>üìä Êï∏ÊìöÂÇô‰ªΩ</strong><br>
                    ÊôÇÈñìÔºö${backupDate.toLocaleString()}<br>
                    È°ûÂûãÔºöÈô£ÂûãËàáÁ≠ÜË®òÂÇô‰ªΩ
                </div>`;
            }
            
            if (!lastBackup && !lastSystemBackup) {
                html += '<div style="text-align: center; color: #6c757d; padding: 20px;">Êö´ÁÑ°ÂÇô‰ªΩË®òÈåÑ</div>';
            }
            
            html += '</div>';
            
            // Ê∑ªÂä†ÂÇô‰ªΩÁµ±Ë®à
            const formations = JSON.parse(localStorage.getItem('footballFormations') || '[]');
            const notes = JSON.parse(localStorage.getItem('footballNotes') || '[]');
            
            html += '<div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">';
            html += '<h4 style="color: #1e3c72; margin-bottom: 10px;">Áï∂ÂâçÊï∏ÊìöÁµ±Ë®à</h4>';
            html += `<p>Èô£ÂûãÊï∏ÈáèÔºö${formations.length}</p>`;
            html += `<p>Á≠ÜË®òÊï∏ÈáèÔºö${notes.length}</p>`;
            html += `<p>ÁêÉÂì°Á∏ΩÊï∏Ôºö30</p>`;
            html += '</div>';
            
            list.innerHTML = html;
            modal.style.display = 'block';
        }

        // Ëá™ÂãïÂÇô‰ªΩË®≠ÂÆö
        function setupAutoBackup() {
            const autoBackupEnabled = localStorage.getItem('autoBackupEnabled') === 'true';
            const autoBackupInterval = localStorage.getItem('autoBackupInterval') || '7'; // È†êË®≠7Â§©
            
            let html = '<div style="margin-bottom: 20px;">';
            html += '<h4 style="color: #1e3c72; margin-bottom: 15px;">Ëá™ÂãïÂÇô‰ªΩË®≠ÂÆö</h4>';
            
            html += '<div style="margin-bottom: 15px;">';
            html += '<label style="display: flex; align-items: center; margin-bottom: 10px;">';
            html += `<input type="checkbox" id="autoBackupCheckbox" ${autoBackupEnabled ? 'checked' : ''} style="margin-right: 10px;">`;
            html += 'ÂïüÁî®Ëá™ÂãïÂÇô‰ªΩÊèêÈÜí';
            html += '</label>';
            html += '</div>';
            
            html += '<div style="margin-bottom: 15px;">';
            html += '<label style="display: block; margin-bottom: 5px;">ÂÇô‰ªΩÊèêÈÜíÈñìÈöîÔºö</label>';
            html += '<select id="backupInterval" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">';
            html += `<option value="1" ${autoBackupInterval === '1' ? 'selected' : ''}>ÊØèÂ§©</option>`;
            html += `<option value="3" ${autoBackupInterval === '3' ? 'selected' : ''}>ÊØè3Â§©</option>`;
            html += `<option value="7" ${autoBackupInterval === '7' ? 'selected' : ''}>ÊØèÈÄ±</option>`;
            html += `<option value="14" ${autoBackupInterval === '14' ? 'selected' : ''}>ÊØè2ÈÄ±</option>`;
            html += `<option value="30" ${autoBackupInterval === '30' ? 'selected' : ''}>ÊØèÊúà</option>`;
            html += '</select>';
            html += '</div>';
            
            html += '<div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 15px;">';
            html += '<strong>üí° Ëá™ÂãïÂÇô‰ªΩË™™ÊòéÔºö</strong><br>';
            html += '‚Ä¢ Á≥ªÁµ±ÊúÉÂú®ÊåáÂÆöÈñìÈöîÂæåÊèêÈÜíÊÇ®ÈÄ≤Ë°åÂÇô‰ªΩ<br>';
            html += '‚Ä¢ ÂÇô‰ªΩÊñá‰ª∂ÊúÉËá™Âãï‰∏ãËºâÂà∞ÊÇ®ÁöÑ‰∏ãËºâË≥áÊñôÂ§æ<br>';
            html += '‚Ä¢ Âª∫Ë≠∞ÂÆöÊúüÂÇô‰ªΩ‰ª•‰øùË≠∑ÈáçË¶ÅÊï∏Êìö<br>';
            html += '‚Ä¢ ÂèØ‰ª•ÊâãÂãïÈóúÈñâËá™ÂãïÂÇô‰ªΩÂäüËÉΩ';
            html += '</div>';
            
            html += '<div style="text-align: center;">';
            html += '<button class="admin-btn success" onclick="saveAutoBackupSettings()">‰øùÂ≠òË®≠ÂÆö</button>';
            html += '<button class="admin-btn" onclick="closeModal(\'autoBackupModal\')" style="margin-left: 10px;">ÂèñÊ∂à</button>';
            html += '</div>';
            
            // ÂâµÂª∫ÊàñÊõ¥Êñ∞Ê®°ÊÖãÊ°Ü
            let modal = document.getElementById('autoBackupModal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'autoBackupModal';
                modal.className = 'modal';
                modal.style.cssText = `
                    display: none;
                    position: fixed;
                    z-index: 1000;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    background-color: rgba(0,0,0,0.5);
                `;
                
                const modalContent = document.createElement('div');
                modalContent.className = 'modal-content';
                modalContent.innerHTML = html;
                modal.appendChild(modalContent);
                document.body.appendChild(modal);
            } else {
                modal.querySelector('.modal-content').innerHTML = html;
            }
            
            modal.style.display = 'block';
        }

        // ‰øùÂ≠òËá™ÂãïÂÇô‰ªΩË®≠ÂÆö
        function saveAutoBackupSettings() {
            const enabled = document.getElementById('autoBackupCheckbox').checked;
            const interval = document.getElementById('backupInterval').value;
            
            localStorage.setItem('autoBackupEnabled', enabled);
            localStorage.setItem('autoBackupInterval', interval);
            
            if (enabled) {
                // Ë®≠ÁΩÆ‰∏ãÊ¨°ÊèêÈÜíÊôÇÈñì
                const nextReminder = new Date();
                nextReminder.setDate(nextReminder.getDate() + parseInt(interval));
                localStorage.setItem('nextBackupReminder', nextReminder.toISOString());
            } else {
                localStorage.removeItem('nextBackupReminder');
            }
            
            closeModal('autoBackupModal');
            alert('Ëá™ÂãïÂÇô‰ªΩË®≠ÂÆöÂ∑≤‰øùÂ≠òÔºÅ');
        }

        // È°ØÁ§∫ÁßªÂãïË®≠ÂÇôÂÇô‰ªΩÈÅ∏È†Ö
        function showMobileBackupOptions(backupData, backupType) {
            // ÁßªÈô§Â∑≤Â≠òÂú®ÁöÑÊ®°ÊÖãÊ°Ü
            const existingModal = document.getElementById('mobileBackupModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            // ÂâµÂª∫Ê®°ÊÖãÊ°Ü
            const modal = document.createElement('div');
            modal.id = 'mobileBackupModal';
            modal.className = 'modal';
            modal.style.cssText = `
                display: block;
                position: fixed;
                z-index: 1000;
                left: 0;
                top: 0;
                width: 100vw;
                height: 100vh;
                background-color: rgba(0,0,0,0.5);
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background-color: white;
                margin: 5vh auto;
                padding: 0;
                border-radius: 15px;
                width: 95vw;
                max-width: 420px;
                max-height: 90vh;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                display: flex;
                flex-direction: column;
                overflow: hidden;
            `;
            
            // Ê®ôÈ°å
            const title = document.createElement('h3');
            title.textContent = 'ÈÅ∏Êìá‰øùÂ≠òÊñπÂºè';
            title.style.cssText = `
                margin: 0;
                padding: 18px 18px 12px 18px;
                color: #1e3c72;
                text-align: center;
                font-size: 1.3rem;
                background: white;
                position: sticky;
                top: 0;
                z-index: 2;
            `;
            // Êñ∞Â¢ûÊòéÈ°ØÊèêÁ§∫
            const shareTip = document.createElement('div');
            shareTip.textContent = 'Âª∫Ë≠∞‰ΩøÁî®„ÄåÂàÜ‰∫´„ÄçÂäüËÉΩÂ∞áÂÇô‰ªΩÂ∞éÂá∫Âà∞ÈÉµ‰ª∂„ÄÅÈõ≤Á´Ø„ÄÅÂæÆ‰ø°Á≠âÊîØÊè¥ÁöÑ App„ÄÇ';
            shareTip.style.cssText = `
                color: #155724;
                background: #d4edda;
                border-left: 4px solid #28a745;
                padding: 10px 18px;
                margin: 0 0 8px 0;
                font-size: 1rem;
                text-align: center;
            `;
            
            // ‰øùÂ≠òÈÅ∏È†ÖÂÆπÂô®
            const optionsContainer = document.createElement('div');
            optionsContainer.style.cssText = `
                flex: 1 1 auto;
                overflow-y: auto;
                padding: 0 18px 0 18px;
                margin-bottom: 0;
                min-height: 0;
            `;
            
            // ÂâµÂª∫ÂÇô‰ªΩÊñá‰ª∂
            const fileName = backupType === 'Á≥ªÁµ±ÂÇô‰ªΩ' ? 
                `football_system_backup_${new Date().toISOString().split('T')[0]}_${new Date().toISOString().split('T')[1].split('.')[0].replace(/:/g, '-')}.json` :
                `football_backup_${new Date().toISOString().split('T')[0]}.json`;
            
            const blob = new Blob([JSON.stringify(backupData, null, 2)], {type: 'application/json'});
            
            // Êñ∞Â¢ûÂèØÊâãÂãïË§áË£ΩÁöÑÂÇô‰ªΩÂÖßÂÆπÂçÄÂ°ä
            const backupTextArea = document.createElement('textarea');
            backupTextArea.value = JSON.stringify(backupData, null, 2);
            backupTextArea.readOnly = true;
            backupTextArea.style.width = '100%';
            backupTextArea.style.height = '180px';
            backupTextArea.style.margin = '12px 0';
            backupTextArea.style.fontSize = '0.95rem';
            backupTextArea.style.fontFamily = 'monospace';
            backupTextArea.style.background = '#f8f9fa';
            backupTextArea.style.border = '1.5px solid #ffc107';
            backupTextArea.style.borderRadius = '8px';
            backupTextArea.style.padding = '10px';
            backupTextArea.style.overflowY = 'auto';
            backupTextArea.title = 'Èï∑ÊåâÂèØÂÖ®ÈÅ∏‰∏¶Ë§áË£Ω';
            // ÊèíÂÖ•Âà∞ÈÅ∏È†ÖÊúÄ‰∏äÊñπ
            optionsContainer.insertBefore(backupTextArea, optionsContainer.firstChild);
            
            // ÈÅ∏È†Ö1: Ë§áË£ΩÂà∞Ââ™Ë≤ºÁ∞ø
            const clipboardOption = createMobileBackupOption(
                'üìã Ë§áË£ΩÂà∞Ââ™Ë≤ºÁ∞ø',
                'Ë§áË£ΩÂÇô‰ªΩÊï∏ÊìöÂà∞Ââ™Ë≤ºÁ∞øÔºåÂèØË≤ºÂà∞Á≠ÜË®òÊáâÁî®',
                () => copyBackupToClipboard(backupData)
            );
            
            // ÈÅ∏È†Ö2: ÂàÜ‰∫´Âà∞Ê™îÊ°àÊáâÁî®
            const shareOption = createMobileBackupOption(
                'üìÅ ÂàÜ‰∫´Âà∞Ê™îÊ°àÊáâÁî®',
                'Â∞áÂÇô‰ªΩÂàÜ‰∫´Âà∞Ê™îÊ°àÁÆ°ÁêÜÂô®„ÄÅÈõ≤Á´ØÁ°¨Á¢üÊàñÂÖ∂‰ªñÊáâÁî®',
                () => shareBackupToFileApp(backupData, blob, fileName)
            );
            
            // ÈÅ∏È†Ö3: ‰ΩøÁî®ÁÄèË¶ΩÂô®‰∏ãËºâ
            const downloadOption = createMobileBackupOption(
                '‚¨áÔ∏è ÁÄèË¶ΩÂô®‰∏ãËºâ',
                'ÂòóË©¶‰ΩøÁî®ÁÄèË¶ΩÂô®‰∏ãËºâÂäüËÉΩ',
                () => tryMobileDownload(blob, fileName)
            );
            
            // ÈÅ∏È†Ö4: ‰øùÂ≠òÂà∞ËèØÁÇ∫Èõ≤Á´ØÁ°¨Á¢ü
            const huaweiCloudOption = createMobileBackupOption(
                '‚òÅÔ∏è ‰øùÂ≠òÂà∞ËèØÁÇ∫Èõ≤Á´ØÁ°¨Á¢ü',
                'Â∞áÂÇô‰ªΩ‰øùÂ≠òÂà∞ËèØÁÇ∫Èõ≤Á´ØÁ°¨Á¢üÔºàÈúÄË¶ÅÂÆâË£ùËèØÁÇ∫Èõ≤Á´ØÁ°¨Á¢üÊáâÁî®Ôºâ',
                () => saveToHuaweiCloud(backupData, fileName)
            );
            
            // ÂèñÊ∂àÊåâÈàï
            const cancelBtn = document.createElement('button');
            cancelBtn.textContent = 'ÂèñÊ∂à';
            cancelBtn.style.cssText = `
                background: #6c757d;
                color: white;
                border: none;
                padding: 16px 0;
                border-radius: 0 0 15px 15px;
                cursor: pointer;
                font-size: 1.1rem;
                width: 100%;
                margin: 0;
                border-top: 1px solid #eee;
                position: sticky;
                bottom: 0;
                left: 0;
                z-index: 2;
            `;
            
            cancelBtn.addEventListener('click', () => {
                modal.remove();
            });
            
            // ÁµÑË£ùÊ®°ÊÖãÊ°Ü
            optionsContainer.appendChild(shareOption);
            optionsContainer.appendChild(clipboardOption);
            // optionsContainer.appendChild(downloadOption); // Â∑≤ÁßªÈô§
            // optionsContainer.appendChild(huaweiCloudOption); // Â∑≤ÁßªÈô§
            
            modalContent.appendChild(title);
            modalContent.appendChild(shareTip);
            modalContent.appendChild(optionsContainer);
            modalContent.appendChild(cancelBtn);
            modal.appendChild(modalContent);
            
            // ÈªûÊìäËÉåÊôØÈóúÈñâ
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
            
            // Ê∑ªÂä†Âà∞È†ÅÈù¢
            document.body.appendChild(modal);
        }

        // ÂâµÂª∫ÁßªÂãïË®≠ÂÇôÂÇô‰ªΩÈÅ∏È†Ö
        function createMobileBackupOption(title, description, onClick) {
            const option = document.createElement('div');
            option.style.cssText = `
                padding: 15px;
                border: 2px solid #e9ecef;
                border-radius: 10px;
                cursor: pointer;
                transition: all 0.3s ease;
                background: #f8f9fa;
                margin-bottom: 10px;
            `;
            
            option.innerHTML = `
                <div style="font-weight: bold; color: #1e3c72; margin-bottom: 5px;">
                    ${title}
                </div>
                <div style="font-size: 0.9rem; color: #6c757d;">
                    ${description}
                </div>
            `;
            
            // ÈªûÊìä‰∫ã‰ª∂
            option.addEventListener('click', () => {
                onClick();
                document.getElementById('mobileBackupModal').remove();
            });
            
            // Êá∏ÂÅúÊïàÊûú
            option.addEventListener('mouseenter', () => {
                option.style.borderColor = '#1e3c72';
                option.style.background = '#e3f2fd';
            });
            
            option.addEventListener('mouseleave', () => {
                option.style.borderColor = '#e9ecef';
                option.style.background = '#f8f9fa';
            });
            
            return option;
        }

        // ÂàÜ‰∫´ÂÇô‰ªΩÂà∞Ê™îÊ°àÊáâÁî®
        function shareBackupToFileApp(backupData, blob, fileName) {
            if (navigator.share) {
                const backupFile = new File([blob], fileName, {type: 'application/json'});
                navigator.share({
                    title: 'Ë∂≥ÁêÉÊà∞Ë°ìÁ≥ªÁµ±ÂÇô‰ªΩ',
                    text: 'Ë∂≥ÁêÉÊà∞Ë°ìÁ≥ªÁµ±Êï∏ÊìöÂÇô‰ªΩÊñá‰ª∂',
                    files: [backupFile]
                }).then(() => {
                    localStorage.setItem('lastBackupTime', new Date().toISOString());
                    updateStats();
                    alert('ÂÇô‰ªΩÂàÜ‰∫´ÊàêÂäüÔºÅË´ãÈÅ∏Êìá‰øùÂ≠ò‰ΩçÁΩÆ„ÄÇ');
                }).catch(err => {
                    console.log('ÂàÜ‰∫´Â§±Êïó:', err);
                    alert('Êú¨Ë®≠ÂÇô‰∏çÊîØÊè¥ÂàÜ‰∫´ÂäüËÉΩÔºåË´ãÊîπÁî®‰∏ãËºâÊàñË§áË£ΩÁ≠âÂÖ∂‰ªñ‰øùÂ≠òÊñπÂºè„ÄÇ');
                });
            } else {
                alert('Êú¨Ë®≠ÂÇô‰∏çÊîØÊè¥ÂàÜ‰∫´ÂäüËÉΩÔºåË´ãÊîπÁî®‰∏ãËºâÊàñË§áË£ΩÁ≠âÂÖ∂‰ªñ‰øùÂ≠òÊñπÂºè„ÄÇ');
            }
        }

        // Ë§áË£ΩÂÇô‰ªΩÂà∞Ââ™Ë≤ºÁ∞ø
        function copyBackupToClipboard(backupData) {
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(JSON.stringify(backupData, null, 2)).then(() => {
                    localStorage.setItem('lastBackupTime', new Date().toISOString());
                    updateStats();
                    alert('‚úÖ ÂÇô‰ªΩÊï∏ÊìöÂ∑≤Ë§áË£ΩÂà∞Ââ™Ë≤ºÁ∞øÔºÅ\n\nüìù ÊâãÂãï‰øùÂ≠òÊ≠•È©üÔºö\n1. ÊâìÈñãË®ò‰∫ãÊú¨ÊàñÊ™îÊ°àÁÆ°ÁêÜÂô®\n2. Âª∫Á´ãÊñ∞Ê™îÊ°à\n3. Ë≤º‰∏äÂÇô‰ªΩÂÖßÂÆπ\n4. ÂÑ≤Â≠òÁÇ∫ .json Ê™îÊ°à\n5. Âª∫Ë≠∞Ê™îÂêçÔºöfootball_backup_Êó•Êúü.json\n\nüí° ÊèêÁ§∫ÔºöÈÇÑÂéüÊôÇÈÅ∏ÊìáÈÄôÂÄã .json Ê™îÊ°àÂç≥ÂèØ');
                }).catch(err => {
                    console.error('Ë§áË£ΩÂ§±Êïó:', err);
                    alert('‚ùå Ë§áË£ΩÂ§±ÊïóÔºåË´ãÊâãÂãïË§áË£Ω‰ª•‰∏ãÊï∏ÊìöÔºö\n\n' + JSON.stringify(backupData, null, 2));
                });
            } else {
                alert('‚ùå ÊÇ®ÁöÑË®≠ÂÇô‰∏çÊîØÊè¥Ââ™Ë≤ºÁ∞øÂäüËÉΩÔºåË´ã‰ΩøÁî®ÂÖ∂‰ªñ‰øùÂ≠òÊñπÂºè„ÄÇ');
            }
        }

        // ÂòóË©¶ÁßªÂãïË®≠ÂÇô‰∏ãËºâ
        function tryMobileDownload(blob, fileName) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            setTimeout(() => {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 100);
            
            localStorage.setItem('lastBackupTime', new Date().toISOString());
            updateStats();
            alert('Â∑≤ÂòóË©¶‰∏ãËºâÂÇô‰ªΩÊñá‰ª∂ÔºåË´ãÊ™¢Êü•ÊÇ®ÁöÑ‰∏ãËºâË≥áÊñôÂ§æ„ÄÇ');
        }

        // ‰øùÂ≠òÂà∞ËèØÁÇ∫Èõ≤Á´ØÁ°¨Á¢üÂäüËÉΩ
        function saveToHuaweiCloud(backupData, fileName) {
            const blob = new Blob([JSON.stringify(backupData, null, 2)], {type: 'application/json'});
            
            if (navigator.share) {
                const backupFile = new File([blob], fileName, {type: 'application/json'});
                navigator.share({
                    title: 'Ë∂≥ÁêÉÊà∞Ë°ìÁ≥ªÁµ±ÂÇô‰ªΩ',
                    text: 'Ë´ãÈÅ∏Êìá‰øùÂ≠òÂà∞ËèØÁÇ∫Èõ≤Á´ØÁ°¨Á¢ü',
                    files: [backupFile]
                }).then(() => {
                    localStorage.setItem('lastBackupTime', new Date().toISOString());
                    updateStats();
                    alert('ÂÇô‰ªΩÊñá‰ª∂Â∑≤Ê∫ñÂÇôÂ•ΩÔºÅË´ãÂú®ÂàÜ‰∫´ÈÅ∏È†Ö‰∏≠ÈÅ∏Êìá„ÄåËèØÁÇ∫Èõ≤Á´ØÁ°¨Á¢ü„ÄçÈÄ≤Ë°å‰øùÂ≠ò„ÄÇ');
                }).catch(err => {
                    // ÂÇôÁî®ÊñπÊ°àÔºö‰∏ãËºâÊñá‰ª∂
                    tryMobileDownload(blob, fileName);
                });
            }
        }

        // ÈªûÊìäÊ®°ÊÖãÊ°ÜÂ§ñÈÉ®ÈóúÈñâ
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>